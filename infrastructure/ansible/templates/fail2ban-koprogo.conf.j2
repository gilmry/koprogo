# /etc/fail2ban/jail.d/koprogo.conf
# Custom fail2ban configuration for KoproGo

[DEFAULT]
# Ban duration in seconds (1 hour)
bantime = 3600

# Time window for counting failures (10 minutes)
findtime = 600

# Action to take (iptables ban + email notification)
action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

[traefik-auth]
enabled = true
port = http,https
logpath = /var/log/traefik/access.log
maxretry = 5
bantime = 1800
findtime = 300
filter = traefik-auth

[traefik-badbots]
enabled = true
port = http,https
logpath = /var/log/traefik/access.log
maxretry = 2
bantime = 86400
findtime = 600
filter = traefik-badbots

[koprogo-api-abuse]
enabled = true
port = http,https
logpath = /var/log/koprogo/backend.log
maxretry = 20
bantime = 3600
findtime = 60
filter = koprogo-api-abuse

[postgres-bruteforce]
enabled = true
port = 5432
logpath = /var/log/postgresql/postgresql-*.log
maxretry = 3
bantime = 7200
findtime = 600
filter = postgres-bruteforce
