################################################################################
# KoproGo Production Environment Variables
# Generated by Ansible on {{ ansible_date_time.iso8601 }}
# Host: {{ ansible_host }}
################################################################################

# GitHub Container Registry
GITHUB_REPOSITORY={{ github_repository | default('gilmry/koprogo') }}
IMAGE_TAG={{ image_tag | default('latest') }}

# Traefik Configuration
ACME_EMAIL={{ acme_email | default('admin@example.com') }}
TRAEFIK_LOG_LEVEL={{ traefik_log_level | default('INFO') }}

# Domain Configuration
{% if domain and domain != '' %}
API_DOMAIN=api.{{ domain }}
FRONTEND_DOMAIN={{ domain }}
{% else %}
API_DOMAIN={{ ansible_host }}
FRONTEND_DOMAIN={{ ansible_host }}
{% endif %}

# Database Configuration
POSTGRES_DB=koprogo_db
POSTGRES_USER=koprogo
POSTGRES_PASSWORD={{ postgres_password | default(lookup('password', '/dev/null chars=ascii_letters,digits length=32')) }}

# Backend Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
RUST_LOG={{ rust_log | default('warn') }}
RUST_BACKTRACE={{ rust_backtrace | default('0') }}
ACTIX_WORKERS={{ actix_workers | default('1') }}
{% if domain and domain != '' %}
CORS_ALLOWED_ORIGINS=https://{{ domain }},https://api.{{ domain }}
{% else %}
CORS_ALLOWED_ORIGINS=http://{{ ansible_host }},http://{{ ansible_host }}:8080
{% endif %}
DB_POOL_MAX_CONNECTIONS={{ db_pool_max_connections | default('8') }}
DB_POOL_MIN_CONNECTIONS={{ db_pool_min_connections | default('2') }}
ENABLE_RATE_LIMITING={{ enable_rate_limiting | default('false') }}
JWT_SECRET={{ jwt_secret | default(lookup('password', '/dev/null chars=ascii_letters,digits,punctuation length=64')) }}

# Frontend Configuration
{% if domain and domain != '' %}
PUBLIC_API_URL=https://api.{{ domain }}/api/v1
{% else %}
PUBLIC_API_URL=http://{{ ansible_host }}:8080/api/v1
{% endif %}
